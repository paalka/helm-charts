sudo: false
language: python
env:
  global:
  - HELM_VERSION="v2.8.2"
  - KUBEVAL_VERSION="0.13.0"
  - CONFTEST_VERSION="0.15.0"
  - secure: "ULSdlsBnR2ceInSFCX1GFci0FOcmi1OH2CTyS5qvjPBMS3x1wzgKUXXaZWuqrY4VS4MKwfYvjzLGMVExz+aCpbuvo7w0cclVGkwy2Lh4TapOdkEApAPbBOCk4xNABixlWVf6Xki/jbPtOoKWlSLbqd5pZvEP2s84E7VxupfD4PonAam6ZJZW0IgKOVBhc+qDiaoYXKLKvkRoVB/4M5hvyUF9bSh+mRkTAn9bD30e3jJQT6QIPGENY7lnGlaP81M5zCOTllNdTVlL+A/9KWs8msk8zpRJfoSn73KcpUS2JtIi7lVsK88pEzvDj3esyTJu6iERS8jApXYoz8KeeJ3rHcl08q4sSuDKT11TL1sUjJWTblhfUxnB09RksFzjTyHRhGTDnV0yWQPeLOSSXlzhFUZmTykfoSaGajHTkY2VsuLtnipYcMTyUeXR6dXhnLyBjhJRRpwdLDlxSnQSxZizu+oV5dNY90wPdskpimY7zD4vBZGN90ngoZt25LPP8EXKSPXLnUM1fv/HZLwJr8AUCZ+nJxKL1zRq+RBXXoaX24ULMB/q9C8q8vt3eR8uJprXWX90LtVojqcxy+HDkoIir07YD83/dymuMGmsT5tFzrtvLNSn0ebDBzR1bG1rxslgcZMYucBkG8DJ8bLHOFQL+Qf0Sy1byn+J6Yn3ruwh4oI="

before_script:
- pip install yq jsonschema pyyaml
- wget "https://storage.googleapis.com/kubernetes-helm/helm-${HELM_VERSION}-linux-amd64.tar.gz"
- tar zxf helm-${HELM_VERSION}-linux-amd64.tar.gz
- mkdir bin
- mv linux-amd64/helm ./bin/helm
- wget "https://github.com/instrumenta/kubeval/releases/download/${KUBEVAL_VERSION}/kubeval-linux-amd64.tar.gz"
- tar zxf kubeval-linux-amd64.tar.gz
- mv kubeval ./bin/
- wget "https://github.com/instrumenta/conftest/releases/download/v${CONFTEST_VERSION}/conftest_${CONFTEST_VERSION}_Linux_x86_64.tar.gz"
- tar zxf conftest_${CONFTEST_VERSION}_Linux_x86_64.tar.gz
- mv conftest ./bin/
- export PATH=$PATH:$PWD/bin/
script:
- "./build/update-chart-repo.sh"
after_success:
- "./build/push.sh"
